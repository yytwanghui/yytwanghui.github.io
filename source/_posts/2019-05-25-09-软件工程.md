---
title: 软件工程-09_体系结构设计
date: 2019-05-25 14:49:32
categories: 
- 软件工程
tags: 
- 软件
- 体系结构
---

<center><font size=4 color="red">本文是一篇关于软件体系结构的文章</font></center>

<!--more-->

# 体系结构设计

## 软件体系结构

#### 什么是体系结构

程序或计算系统的软件体系结构是指系统的一个或者多个结构，它包括软件构件、构件的外部可见属性以及它们之间的相互关系

体系结构并非可运行的软件，确切说，它是一种表达，能够：

* 1.对设计在满足既定需求方面的有效性进行分析

* 2.在设计变更相对容易的阶段，考虑体系结构可能的选择方案

* 3.降低与软件构造相关的风险

"体系结构"和"设计"的区别:类与对象之间的区别

例如：使用Java和.NET对同一个项目进行设计，其设计方法是不一样的，但其体系结构是一样的。只有对一个项目的体系结构想的越明白，设计就越容易

#### 体系结构为什么重要

* 软件体系结构的表示有助于对计算机系统开发感兴趣的各方(利益相关者)开展交流

* 体系结构突出了早期的设计决策，这些决策对随后所有的软件工程工作有深远的影响，同时对系统作为一个可运行实体的最后成功有重要作用

* 体系结构“构建了一个相对小的、易于理解的模型，该模型描述了系统如何构成以及其构件如何一起工作”

#### 体系结构描述

不同利益相关者会从不同的角度理解体系结构，它是有不同的关注点驱动的，所以，体系结构描述实际上是一组体现系统不同视图的工作产品。体系结构应当考虑到每个利益相关者想要的东西

#### 体系结构决策

体系结构决策描述模版

```md
每个主要的体系结构决策可以被记录在案，以便以后评审，评审由想要理解已提出的体系结构描述的利益相关者进行。

设计问题：描述将要解决的体系结构设计问题
解决方案：陈述所选择的解决设计问题的方法
分类：指定问题和解决方案陈述的分类(例如，数据设计、内容结构、构件结构、集成、介绍)
假设：指出任何有助于指定决策的假设
约束：指定任何有助于指定决策的环境约束(例如，技术标准、可用的模版、项目相关问题)
候选方案：简要描述所考虑的体系结构设计候选方案，并描述为什么要摒弃这些方案
争论：陈述你为什么选择了这种解决方案而不是其他的候选方案
意义：指出制定决策对设计的影响。选择方案如何影响其他的体系结构设计问题？解决方案会在某种程度上约束设计吗？
相关策略：其他记录的决策和该决策有什么相关性？
相关关注点：其他需求和该决策有什么相关性？
工作产品：指出体系结构描述中，决策会在哪里体现出来
注释：参考可用来制定决策的其他团队的备忘录或文档
```

## 体系结构类型

体系结构类型：如今社会软件设计常见的

```md
人工智能
商业和非盈利的
通信
内容制作
设备
娱乐于运动
金融
游戏
行政管理
工业
法律
医疗
军事
操作系统
平台
科学
工具
运输
实用程序
```

以上每种类别在如今社会中都已经形成了相应的体系结构，每种类别的具体分类要采用更具体的体系结构。例如：游戏，也分塔防游戏，益智游戏，战略游戏，枪战游戏

## 体系结构风格

由相关的体系结构风格就能理解系统的整体性质。这就像，我要盖个“茅草屋”，你在脑子里就能想到“茅草屋”的大概样子

5种典型的基本体系结构

```md
功能结构：构件表示功能或实体，连接件表示接口。特性描述构件的特性和接口的组织

实现结构：购进可以是包、类、对象、过程、函数、方法等所有在不同抽象层上打包的功能。连接件包括传递数据和控制、共享数据、“使用”以及“是一个实例”等能力。特性关注于结构实现时的质量特性(例如：可维护性、可重用性)

并发结构：构件表示“并发单元”(并发任务或线程)。“关系”(连接件)包括同步于、优先级高于、发送数据到、运行必须有、运行不能有。与结构相关的特性包括优先级、抢先占有以及执行时间

物理结构：类似于设计开发中的部署模型。构件是物理硬件，软件驻留在硬件上。连接件是硬件构件之间的接口。特性用来描述容量、带宽、性能和其他属性

开发结构：该结构定义构件、工作产品以及软件工程过程中所需的其他信息源。连接件表示工作产品之间的关系。特性标识每项的特征
```

#### 体系结构风格的简单分类

几种常见的体系结构

* 以数据为中心的体系结构：核心是数据库

![](https://i.loli.net/2019/05/24/5ce7940476b2124587.jpg)

* 数据流体系结构

![](https://i.loli.net/2019/05/24/5ce795ba19b1a61852.png)

* 调用和返回体系结构

    * 主程序/子程序体系结构：主程序调用一组构件，这些构件又调用其他构件

    ![](https://i.loli.net/2019/05/24/5ce795c58014e26384.png)
    
    * 远程过程调用体系结构：主程序/子程序体系结构的构件分布在网络中的多台计算机上

* 面向对象体系结构

* 层次体系结构：参考MVC设计模式考虑

#### 体系结构模式

12章再讲

#### 组织和求精

体系结构设计的评估标准

控制：

```md
在体系结构中如何管理控制？
是否存在清晰的控制层次？
如果存在，构件在控制层次中有什么作用？
构件如何在系统中传递控制？
构件间如何共享控制？
控制的拓扑结构如何？
控制是否同步或者构件操作是否异步？
```

数据

```md
构件间如何进行数据通信？
数据流是否是连续地传递给系统，或数据对象是否是零散地传递给系统？
数据传递的模式是什么(即，数据是从一个构件传递到另一个构件，还是数据被系统中的构件全局共享)？
是否存在数据构件(如黑板或中心数据库)？如果存在，它们的作用是什么？
功能构件如何和数据构件交互？
数据构件是被动的还是主动的(即数据构件是否主动地和系统的其他构件交互)？
数据和控制如何在系统中交互？
```

## 体系结构设计

#### 系统环境的表示

体系结构环境图的一般结构

![](https://i.loli.net/2019/05/25/5ce8b5999ec5776790.png)

由图所示，与目标系统(为该系统所开发的体系结构设计)交互的系统可以表示为：

* 上级系统----这些系统把目标系统作为某些高层处理方案的一部分

* 下级系统----这些系统被目标系统使用，并为完成目标系统的功能提供必要的数据和处理

* 同级系统----这些系统在对等的基础上相互作用(即信息或者同级系统和目标系统产生，或者被目标系统和同级系统使用)

* 参与者------通过产生和消耗必要处理所需的信息，实现与目标系统交互的实体(人，设备)

每个外部实体都通过某一个接口(带阴影的小矩形)与目标系统进行通信

#### 定义原型

原型是表示核心抽象的类或模式

原型包括：结点、探测器、指示器、控制器

#### 将体系结构精华为构件

一个将完整体系结构精华为构件的实例

![](https://i.loli.net/2019/05/25/5ce8baaf5fbe956921.png)

其中的每一个方框都是一个构件

#### 描述系统实例

将上文中的完整体系结构再进一步精华

```md
体系结构设计
    目的：体系结构设计工具通过描述构件接口、依赖与联系以及交互作用来建立整体软件结构模型
    机制：工具采用的机制多种多样。在大多数情况下，体系结构的设计能力是分析和设计建模自动化工具的一部分功能
    代表性工具：
    Adalon
    ObjectiF
    Rational Rose
```

## 评估可选的体系结构设计

#### 体系结构权衡分析方法

目的：验证设计的体系结构是否能用

* 1.收集场景：开发一组用例，从用户角度描述系统

* 2.引出需求、约束和环境描述：确保所有利益相关者问题都被处理

* 3.描述那些已经被选择用于解决场景和需求的体系结构风格/模式：采用以下一种描述

    * a.模块视图：分析带有构件的工作任务以及信息隐蔽获得的程度

    * b.过程视图：分析系统性能

    * c.数据流视图：分析体系结构满足功能需求的程度

* 4.通过单独地考虑每个属性来评估质量属性：包括可靠性、性能、安全性、可维护性、灵活性、可测试性、可移植性、可复用性和互操作性

* 5.针对特定的体系结构风格，确定质量属性对各种体系结构属性的敏感性：通过体系结构变更测试，受变更大的就是敏感点

* 6.找第5步的敏感点，然后做成候选体系结构

#### 体系结构复杂性

体系结构的复杂性体现在体系结构中构件间的依赖关系，包括

* 1.共享依赖：存在与使用相同资源的消费者或相同消费者生产的生产者之间的依赖关系

* 2.流依赖：生产者和消费者之间的依赖

* 3.约束依赖：一组活动间相关控制流上的约束

#### 体系结构描述语言

体系结构描述语言(architectural description language,ADL)提供了一种描述软件体系结构的语义和语法

UML没有ADL完成，以下是5个ADL

```md
Rapide:
UniCon
Aesop
Wright
Acme
```

## 使用数据流进行体系结构映射

从DFD到软件体系结构的便捷的转化，转化由下述6个步骤的一部分完成

* 1.建立信息流的类型

* 2.标注流的边界

* 3.将DFD映射到程序结构

* 4.定义控制层级

* 5.使用设计度量和启发式精华产生的结构

* 6.求精华细化体系结构描述

#### 变换映射

将具有变换流特征的DFD映射为某个特定的体系结构风格，图示为SafeHome的安全例子

**步骤1：评审基本系统模型**
* DFD图从0层到1层的转换

![](https://i.loli.net/2019/05/25/5ce8d5161de4998095.png)

**步骤2：评审和精华软件的数据流图**
* DFD图从1层到2层到转换

![](https://i.loli.net/2019/05/25/5ce8d5200897a87808.png)

**步骤3：确定DFD是否含有变换流或事物流特征**
* DFD图从2层到3层的转换，这次转换要搞清楚数据流的输入和输出

![](https://i.loli.net/2019/05/25/5ce8d5278ae5e31684.png)

**步骤4：通过确定输入和输出流的边界，分离出变换中心**
* 输入是信息从外部形式转内部形式，输出是信息从内部形式转外部形式
流边界是指在流从外部转内部(或从内部转外部)的边界处

![](https://i.loli.net/2019/05/25/5ce8d5301579c36594.png)

**步骤5:完成“第一级分解”**
* 以步骤4的边界处为界限进行第一级的分解

![](https://i.loli.net/2019/05/25/5ce8d537c7e1e69811.png)

**步骤6:完成“第二级分解”**
* 将每个变换(泡泡)映射到体系结构中的相应模块，从变换中心的边界开始，沿输入路径和输出路径向外，将变换依次映射到软件结构的从属层。一般是一对一映射，有时会有多个泡泡合并为一个构件，或者一个泡泡分解为多个构件的情况。这步结束，就得到了第一次的迭代体系结构

![](https://i.loli.net/2019/05/25/5ce8d53f85e5c49088.png)

**步骤7:使用提高软件质量的设计启发式方法，精华第一次迭代得到的体系结构**
* 精化第一次迭代得到的体系结构。对构件进行“分解”和“结合”

![](https://i.loli.net/2019/05/25/5ce8d5468f2e424959.png)

**最终逐渐精华的完善版**

* 构件的和并和消除

![](https://i.loli.net/2019/05/25/5ce8d6aec130c48135.png)

#### 精华体系结构设计

不能工作的“优化设计”是值得怀疑的

设计求精应在满足有效模块要求的前提下尽量减少构件的数量，在充分满足信息需求的前提下尽量减少复杂的数据结构
